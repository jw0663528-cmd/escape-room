<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>פרויקט קולקס | חדר בריחה ביומימטי</title>
    <style>
        :root {
            --primary-color: #00ff41; /* Green Terminal */
            --secondary-color: #0c0c0c; /* Black Background */
            --danger-color: #ff3333;
            --accent-color: #008f11;
            --glass-panel: rgba(0, 20, 0, 0.85);
            --font-main: 'Courier New', Courier, monospace;
        }

        * {
            box-sizing: border-box;
            user-select: none;
        }

        body {
            margin: 0;
            padding: 0;
            background-color: var(--secondary-color);
            color: var(--primary-color);
            font-family: var(--font-main);
            height: 100vh;
            display: flex;
            flex-direction: column;
            overflow: hidden;
            background-image: radial-gradient(circle, #112211 0%, #000000 100%);
        }

        /* --- UI Elements --- */
        #game-container {
            width: 100%;
            max-width: 800px;
            margin: 0 auto;
            flex-grow: 1;
            display: flex;
            flex-direction: column;
            justify-content: center;
            padding: 20px;
            position: relative;
        }

        .screen {
            background: var(--glass-panel);
            border: 2px solid var(--accent-color);
            border-radius: 10px;
            padding: 30px;
            box-shadow: 0 0 20px rgba(0, 255, 65, 0.2);
            display: none; /* Hidden by default */
            animation: fadeIn 0.5s ease-in-out;
            max-height: 80vh;
            overflow-y: auto;
        }

        .screen.active {
            display: block;
        }

        h1, h2 {
            text-transform: uppercase;
            border-bottom: 1px dashed var(--primary-color);
            padding-bottom: 10px;
            text-shadow: 0 0 5px var(--primary-color);
        }

        p {
            line-height: 1.6;
            font-size: 1.1rem;
            margin-bottom: 20px;
        }

        .status-bar {
            display: flex;
            justify-content: space-between;
            padding: 10px 20px;
            background: #001100;
            border-bottom: 2px solid var(--accent-color);
            font-weight: bold;
            font-size: 1.2rem;
        }

        .stat-item span {
            color: white;
        }

        /* --- Components --- */
        button {
            background: transparent;
            border: 1px solid var(--primary-color);
            color: var(--primary-color);
            padding: 10px 20px;
            font-family: var(--font-main);
            font-size: 1rem;
            cursor: pointer;
            margin: 5px;
            transition: all 0.3s;
        }

        button:hover {
            background: var(--primary-color);
            color: black;
            box-shadow: 0 0 10px var(--primary-color);
        }

        input[type="text"], input[type="number"] {
            background: black;
            border: 1px solid var(--primary-color);
            color: var(--primary-color);
            padding: 10px;
            font-family: var(--font-main);
            font-size: 1rem;
            width: 200px;
            text-align: center;
        }

        input:focus {
            outline: none;
            box-shadow: 0 0 10px var(--accent-color);
        }

        .hidden {
            display: none !important;
        }

        /* --- Puzzle Specifics --- */
        .puzzle-options {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .foggy-glass {
            background: rgba(255, 255, 255, 0.1);
            padding: 20px;
            border-radius: 5px;
            text-align: center;
            filter: blur(8px); /* The Blur Effect */
            transition: filter 2s ease;
            cursor: pointer;
            border: 1px solid white;
            color: white;
            font-weight: bold;
            font-size: 2rem;
            margin: 20px 0;
            user-select: none;
        }

        .foggy-glass.cleared {
            filter: blur(0px);
            background: rgba(0, 50, 0, 0.5);
        }

        .switch-board {
            display: flex;
            justify-content: space-around;
            margin-top: 20px;
        }

        .switch-btn {
            width: 80px;
            height: 80px;
            border-radius: 50%;
            border: 2px solid var(--primary-color);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2rem;
        }

        /* --- Animations --- */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        @keyframes shake {
            0% { transform: translateX(0); }
            25% { transform: translateX(-5px); }
            50% { transform: translateX(5px); }
            75% { transform: translateX(-5px); }
            100% { transform: translateX(0); }
        }

        .shake {
            animation: shake 0.4s ease-in-out;
            border-color: var(--danger-color);
            color: var(--danger-color);
        }

        /* --- Responsive --- */
        @media (max-width: 600px) {
            h1 { font-size: 1.5rem; }
            .status-bar { font-size: 0.9rem; }
        }
    </style>
</head>
<body>

    <div class="status-bar">
        <div class="stat-item">מיקום: <span id="location-display">כניסה</span></div>
        <div class="stat-item">נוגדנים: <span id="antidote-display">6</span>/6</div>
    </div>

    <div id="game-container">

        <div id="screen-intro" class="screen active">
            <h1>פרויקט קולקס</h1>
            <p>שלום, נסיין מספר 894.</p>
            <p>אתה נמצא ברכבת המאיצה לעבר הלא נודע. יש 10 קרונות. בחצי מהם יש גז עצבים קטלני.</p>
            <p>לרשותך 6 מנות נוגדן בלבד. הטעויות כאן עולות ביוקר.</p>
            <p>הכלי היחיד שלך להישרדות הוא הביומימיקרי: ללמוד מהיתוש כדי לשרוד את המלכודת.</p>
            <button onclick="startGame()">התחל סימולציה</button>
        </div>

        <div id="screen-car1" class="screen">
            <h2>קרון 1: פחד</h2>
            <p>הטיימר רץ. ילדה קטנה בשם מאיה יושבת על הרצפה וחוסמת את המעבר. היא צריכה את הנוגדן כדי לעבור לקרון הבא, אבל היא בועטת וצורחת מפחד מהמזרק.</p>
            <p><strong>איך תשכנע אותה לקבל את הזריקה?</strong></p>
            <div class="puzzle-options">
                <button onclick="checkAnswer1(1)">"מאיה, אין ברירה! תחזיקי חזק, זה יכאב רק לשנייה."</button>
                <button onclick="checkAnswer1(2)">"תראי, המזרק הזה הוא כמו חדק של ייתוש. הוא רוטט ודק מאוד, את אפילו לא תרגישי."</button>
                <button onclick="checkAnswer1(3)">"אם לא תזוזי הגז יגיע. קחי סוכרייה ותני לי את היד."</button>
            </div>
            <p id="feedback-1" style="margin-top:10px; font-weight:bold;"></p>
        </div>

        <div id="screen-car4" class="screen">
            <h2>קרון 4: ניווט עיוור</h2>
            <p>הגעתם לפיצול. המסדרון מלא בעשן סמיך. אי אפשר לראות כלום. יש לך רחפן זעיר (MAV) בערכה.</p>
            <p>כדי שהרחפן יתייצב בתוך זרמי האוויר והעשן, עליך לכייל את תדר המנוע שלו לתדר נפנוף הכנפיים של היתוש.</p>
            <p><em>רמז: יתושים מנפנפים בכנפיים בתדר גבוה מאוד, בין 500 ל-700 הרץ. הכיול המדויק לרחפן זה הוא האמצע בדיוק.</em></p>
            
            <div style="text-align: center; margin-top: 20px;">
                <input type="number" id="drone-input" placeholder="הכנס תדר (Hz)">
                <button onclick="checkDrone()">שגר רחפן</button>
            </div>
        </div>

        <div id="screen-car7" class="screen">
            <h2>קרון 7: ראייה בלתי אפשרית</h2>
            <p>הדלת לקרון הבא נעולה בקוד דיגיטלי. הקוד כתוב על דופן הזכוכית, אבל החדר מלא באדים רותחים והזכוכית מכוסה לחלוטין באדים.</p>
            <p>בתיק שלך יש תרסיס המבוסס על <strong>עיני היתוש</strong> (ננו-מבנה דוחה מים).</p>
            <p>לחץ על הזכוכית כדי לרסס את החומר ולחשוף את הקוד.</p>
            
            <div id="foggy-glass" class="foggy-glass" onclick="clearFog()">
                CODE: 8432
            </div>

            <p>הכנס את הקוד שגילית:</p>
            <div style="text-align: center;">
                <input type="text" id="code-input" placeholder="קוד הדלת">
                <button onclick="checkCode()">פתח דלת</button>
            </div>
        </div>

        <div id="screen-car10" class="screen">
            <h2>קרון 10: חושך מוחלט</h2>
            <p>הגעת למדען המטורף, ד"ר ארקדיוס. החדר חשוך לגמרי. הוא מחזיק את המפתח.</p>
            <p>יש 3 מתגים על הקיר מולך. אחד מדליק את האור ומסיים את המשחק, השניים האחרים משחררים גז.</p>
            <p>אתה משתמש במיקרופון הכיווני (בהשראת איבר ג'ונסטון במחושים). אתה שומע את תקתוק השעון שלו.</p>
            <p style="border: 1px solid var(--primary-color); padding: 10px; font-family: monospace;">
                > ניתוח אודיו...<br>
                > אות מזוהה: 20dB<br>
                > כיוון מקור: 270 מעלות (צד שמאל)<br>
            </p>
            <p>איזה מתג תלחץ?</p>

            <div class="switch-board">
                <div class="switch-btn" onclick="checkSwitch('left')" style="cursor:pointer;">L</div>
                <div class="switch-btn" onclick="checkSwitch('center')" style="cursor:pointer;">C</div>
                <div class="switch-btn" onclick="checkSwitch('right')" style="cursor:pointer;">R</div>
            </div>
        </div>

        <div id="screen-win" class="screen">
            <h1 style="color: var(--primary-color);">משימה הושלמה</h1>
            <p>האורות נדלקים. ארקדיוס נלכד. הצלת את הנוסעים.</p>
            <p>הוכחת שהבנה עמוקה של הטבע היא הכלי החזק ביותר.</p>
            <p><strong>סטטוס סופי:</strong> <span id="final-score"></span> נוגדנים נותרו.</p>
            <button onclick="location.reload()">שחק שוב</button>
        </div>

        <div id="screen-lose" class="screen">
            <h1 style="color: var(--danger-color);">נכשלת</h1>
            <p>אזלו הנוגדנים. הגז השתלט על מערכת העצבים שלכם.</p>
            <p>הניסוי של ד"ר ארקדיוס הצליח, אבל אתם לא שרדתם כדי לספר.</p>
            <button onclick="location.reload()">נסה שוב</button>
        </div>

    </div>

    <script>
        // Game State
        let antidotes = 6;
        let currentScreen = 'screen-intro';
        
        // DOM Elements
        const antidotesDisplay = document.getElementById('antidote-display');
        const locationDisplay = document.getElementById('location-display');

        // Functions
        function updateStats(locationName) {
            antidotesDisplay.innerText = antidotes;
            if(antidotes <= 0) {
                showScreen('screen-lose');
                return;
            }
            if(locationName) {
                locationDisplay.innerText = locationName;
            }
        }

        function showScreen(screenId) {
            // Hide all screens
            document.querySelectorAll('.screen').forEach(el => el.classList.remove('active'));
            // Show target screen
            const target = document.getElementById(screenId);
            if(target) {
                target.classList.add('active');
                currentScreen = screenId;
            }
        }

        function startGame() {
            showScreen('screen-car1');
            updateStats('קרון 1');
        }

        function reduceAntidote() {
            antidotes--;
            updateStats();
            // Visual feedback
            document.body.style.boxShadow = "inset 0 0 50px red";
            setTimeout(() => {
                document.body.style.boxShadow = "none";
            }, 500);
        }

        // --- Puzzle 1 Logic (Maya) ---
        function checkAnswer1(option) {
            const feedback = document.getElementById('feedback-1');
            if (option === 2) {
                // Correct
                feedback.style.color = 'var(--primary-color)';
                feedback.innerText = "מאיה נרגעה: 'זה באמת לא כאב!'. הדלת נפתחה.";
                setTimeout(() => {
                    showScreen('screen-car4');
                    updateStats('קרון 4');
                }, 2000);
            } else {
                // Wrong
                feedback.style.color = 'var(--danger-color)';
                if (option === 1) feedback.innerText = "היא נכנסה לטראומה וזזה ברגע האחרון. בזבזת מנה.";
                if (option === 3) feedback.innerText = "אין זמן לסוכריות! הגז חודר. בזבזת מנה בלחץ.";
                reduceAntidote();
            }
        }

        // --- Puzzle 2 Logic (Drone) ---
        function checkDrone() {
            const input = document.getElementById('drone-input');
            const val = parseInt(input.value);
            
            if (val === 600) {
                alert("הרחפן התייצב! חיישני ה-CO2 מזהים מעבר בטוח.");
                showScreen('screen-car7');
                updateStats('קרון 7');
            } else {
                input.classList.add('shake');
                setTimeout(() => input.classList.remove('shake'), 500);
                alert("כיול שגוי. הרחפן התרסק בקיר. אתה חייב להזריק נוגדן נגד הגז שדלף.");
                reduceAntidote();
                input.value = '';
            }
        }

        // --- Puzzle 3 Logic (Fog/Eyes) ---
        function clearFog() {
            const glass = document.getElementById('foggy-glass');
            if (!glass.classList.contains('cleared')) {
                glass.classList.add('cleared');
                // Play a sound effect logic could go here
            }
        }

        function checkCode() {
            const input = document.getElementById('code-input');
            if (input.value === '8432') {
                showScreen('screen-car10');
                updateStats('קרון 10 - חדר בקרה');
            } else {
                input.classList.add('shake');
                setTimeout(() => input.classList.remove('shake'), 500);
                alert("קוד שגוי. הדלת נעולה. מנת נוגדן בוזבזה בניסיון פריצה כושל.");
                reduceAntidote();
            }
        }

        // --- Puzzle 4 Logic (Sound) ---
        function checkSwitch(direction) {
            if (direction === 'left') {
                document.getElementById('final-score').innerText = antidotes;
                showScreen('screen-win');
                updateStats('חופש');
            } else {
                alert("שמעת רעש של גז משתחרר... זה היה המתג הלא נכון!");
                reduceAntidote();
                // If they survive the mistake (have antidotes left), they can try again
                if (antidotes > 0) {
                    alert("שרדת את הגז, נסה שוב להקשיב לכיוון.");
                }
            }
        }

    </script>
</body>
</html>
